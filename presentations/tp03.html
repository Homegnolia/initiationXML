<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Programme</title>
      <link href="themes/remark-dark.css" rel="stylesheet" media="all" type="text/css">
   </head>
   <body><textarea id="source">
title: Initiation à XML du CRIHNTP03 – Éditer un document d’après un schéma
description: Lou Burnard Consulting,
theme: theme/remark-dark-em.css
name: inverse
layout: true
class: inverse

---
class: center middle



# TP03 – Utiliser un schéma

## Introduction à XML | CRIHN, 17 février 2017

.footnote[[Répertoire GitHub](https://github.com/publicarchitectura/initiationXML) | [Programme](00-programme.html)]


---


# Introduction

Dans ce premier exercice, nous allons nous servir d’oXygen pour&nbsp;:
* la création d’un nouveau document XML

* le balisage progressif d’un document

* la validation continue d’un document

* l’affichage du document sans balise


---


# Création d’un document nativement-numérique

La [Text Encoding Initiative (TEI)](http://tei-c.org) propose un vocabulaire et des schémas destinés à l’édition des sources textuelles historiques ou littéraires. Mais la TEI ne sert pas uniquement à l’encodage de documents déjà existants sous forme manuscrite ou imprimée ou de textes épigraphiques. Elle peut aussi être utilisée pour la création de nouveaux documents créés ex nihilo.

* Ouvrir oXygen

* Cliquez sur l’icône `Nouveau` en haut à gauche (ou sélectionnez `Nouveau` dans le menu `Fichier`, ou bien tapez `Ctrl` + `N`) pour ouvrir la boîte de dialogue `Nouveau`

* Choisissez `Cadre des modèles`, et dans la liste sélectionnez `TEI P5`, puis `Bare`, pour choisir un schéma TEI minimal.

![](../images/new-bare-1.png)

* Cliquez sur le bouton `Créer` en bas de la fenêtre.

oXygen ouvre un document TEI que vous allez pouvoir compléter.

Le schéma TEI Bare que vous avez choisi contient un minimum de balises, mais il permet quand-même de décrire un document TEI complet.

On est maintenant dans l’espace de travail typique d’oXygen. Par défaut, il y a plusieurs fenêtre, autour de la fenêtre principale où nous allons pouvoir éditer notre document. Sur le côté gauche, dans la vue `Sommaire` s’affiche la structure hiérarchique de votre document.

Remarquez qu’un document TEI se compose de deux parties&nbsp;: En tête du fichier, vous trouvez les métadonnées, entourées par la balise `&lt;teiHeader&gt;`. Ensuite, un élément qui va contenir le texte de votre document, encadré par la balise `&lt;text&gt;`.

![](../images/nouveau-bare-2.png)

Remarques que vous pouvez modifier l’affichage du document en cliquant sur les boutons Texte, Grille, ou Auteur en bas de la fenêtre principale. Le mode auteur permet d’afficher votre document dans un éditeur WYSIWIG. Comme nous n’avons pas peur des balises, nous allons commencer à éditer le document en mode Texte&nbsp;!

On va d’abord fournir les métadonnées minimales nécessaires pour tout nouveau document TEI&nbsp;: le titre du fichier, des informations sur sa publication, et sa source. oXygen vous propose des éléments pré-remplis que nous allons modifier et compléter.
* À l’intérieur de la balise `&lt;title&gt;`, donnez un titre à votre document. À vous de choisir&nbsp;! Cela peut être Mon premier document TEI&nbsp;! .

* Remplacez les deux autres contenus textuels proposés par défaut par des mentions plus appropriées. Par exemple, pour publication, on pourrait mettre Brouillon inédit ou Distribué sur mon blog&nbsp;; dans `&lt;sourceDesc&gt;`, on vous propose Œuvre originale, guidée par une formation TEI.


Par défaut, oXygen cherche à maintenir votre document dans un état valide. Qu’arrive-t-il si vous endommagez la structure hiérarchique de votre document&nbsp;?
* Effacez quelques lettres à l’intérieur de n’importe quelle balise&nbsp;: par exemple changez `&lt;publicationStmt&gt;` en `&lt;publicat&gt;`.

* Observez ce que fiat oXygen&nbsp;:&nbsp;le logiciel a changé la balise fermante correspondante pour lui faire correspondre le nouveau nom que vous lui avez donnée afin que le document reste bien formé. Mais celui-ci n’est plus valide contre le schéma TEI bare (qui ne définit aucune balise publicat). Par conséquent, les balises qui ne sont pas définies dans le schéma sont désormais soulignées en rouge&nbsp;et un message d’erreur s’affiche en bas de l’écran. Remarquez aussi l’indicateur rouge sur le côté droit de votre fenêtre principale.

* Cliquez sur ces indicateurs pour essayer de comprendre la manière dont une erreur peut en entraîner une autre.

* Tapez `Ctrl` + `Z` (ou sélectionnez `Annuler` dans le menu `Édition`) pour revenir dans un état de grâce… L’indicateur rouge, en haut à droite de la fenêtre principale, reprend sa couleur verte après correction de toutes les erreurs.


Puisque votre document XML est associé à un schéma, oXygen va vous permettre d’ajouter facilement les balises définies dans le modèle de document.
* Placez le curseur après la balise fermante `&lt;/title&gt;` et juste avant la balise fermante `&lt;/titleSmt&gt;`;

* Tapez `&lt;` et arrêtez-vous un instant ;

* L’indicateur vert repasse au rouge, parce que vous n’avez pas encore entré le nom de l’élément souhaité.

* Dans une fenêtre contextuelle, oXygen vous propose une liste des balises disponibles à cet emplacement dans le document&nbsp;: vous pouvez insérer ici un élément `&lt;author&gt;` ou encore un élément `&lt;title&gt;`, ou bien fermer l’élément `&lt;titleStmt&gt;`, ou encore insérer un commentaire XML, etc.

* Tapez sur la touche `Entrée` pour accepter le premier choix. oXygen insère dans votre document la balise ouvrante `&lt;author&gt;` et la balise fermante `&lt;/author&gt;`.

* Le curseur se place automatiquement à l’intérieur de la balise ouvrante, dans le cas où vous voudriez spécifier ses attributs. Déplacez le curseur d’un caractère vers la droite à l’intérieur de l’élément et renseignez votre nom, comme auteur du fichier.


---


# Ajout de texte au document

Voilà, nous sommes prêts à commencer la rédaction de notre document à l’intérieur de l’élément `&lt;text&gt;`&nbsp;! À vous de décider de son contenu et de son balisage.

Identifiez d’abord, les composants disponibles pour dans votre document pour baliser le texte. À l’intérieur de l’élément `&lt;text&gt;`, vous avez un élément `&lt;body&gt;`. Au sein de cet élément `&lt;body&gt;`, le schéma bare vous permet d’employer&nbsp;:
* des titres… que vous balisez avec la balise `&lt;head&gt;`

* des chapitres… que vous balisez avec la balise `&lt;div&gt;`

* des listes… à baliser avec la balise `&lt;list&gt;` puis des sous-éléments `&lt;item&gt;`

* des paragraphes… à baliser avec la balise `&lt;p&gt;`
Allons-y&nbsp;!

Dans la suite de ce petit tutoriel, nous allons vous présenter quelques fonctionnalités utiles offertes par ce logiciel.

D’abord, une question importante&nbsp;: Pour le contenu, OK, il faut le créer —&nbsp;mais est-ce qu’il faut toujours taper soi-même les balises&nbsp;? Non&nbsp;: oXygen est là pour vous aider. Vous avez déjà vu comment il peut vous proposer la liste des balises disponibles à un certain emplacement du document. Il peut aussi vous suggérer comment baliser un morceau de texte sélectionné.

* Avec la souris, sélectionnez le contenu du `&lt;body&gt;`, i.e. la séquence `&lt;p&gt;Some text here&lt;/p&gt;, y compris les balises.`.

* Tapez `Ctrl`+ `E` (ou sélectionnez `XML Refactoring` et ensuite `Entourer des balises` dans le menu `Document`).

* oXygen vous propose toutes les balises qui pourraient éventuellement être insérées à cet endroit précis du document&nbsp;: dans ce cas, il est conseillé de sélectionner `&lt;div&gt;`. Puis, cliquez sur `Accepter`

* L’élément `&lt;div&gt;` va contenir le premier chapitre de votre document. Insérez donc un titre au début de ce `&lt;div&gt;`, en vous servant de la balise `&lt;head&gt;`

* Il serait aussi utile de numéroter vos chapitres d’une manière explicite&nbsp;: pour cela, on vous propose l’attribut `@n` qui est disponible sur n’importe quel élément TEI, y compris `&lt;div&gt;`.

* Mettez le curseur à l’intérieur de la balise `&lt;div&gt;` juste avant le &gt; et tapez un seul espace. oXygen vous propose un menu des attributs disponibles.

* Tapez sur ENTRÉE pour sélectionnez `@n`. oXygen vous informe qu’il faut dans ce cas ajouter une valeur, et le curseur reste entre les guillemets.

* Tapez (par exemple) `1`, et votre document redeviendra valide.

Votre document devrait maintenant ressembler à ceci :

![](../images/body-shot.png)

À vous d’ajouter maintenant du texte à ce paragraphe, de préférence un peu plus intéressant que some text here&nbsp;! Décrivez-nous vos premières réactions avec oXygen&nbsp;; partagez vos idées sur la situation politique actuelle&nbsp;; écrivez ce que vous voulez.

Sans doute aurez-vous besoin de plus d’un seul paragraphe. Comment faire pour terminer celui-ci et commencer un nouveau&nbsp;? Bien-sûr, on peut simplement taper les balises `&lt;/p&gt;&lt;p&gt;` mais il y a une manière plus simple de le faire.

Supposons que vous avez maintenant quelques centaines de mots dans votre seul paragraphe, et que vous voulez le diviser en plusieurs.

* Placez le curseur au point de chaque division souhaitée

* Tapez `Alt` + `Maj` + `D` ou sélectionnez `Refactorisation` dans le menu contextuel puis `Élément de division` dans le menu `Document`.

Vous pouvez faire pareil pour diviser le chapitre unique, mais attention à bien choisir un endroit valide pour effectuer la division&nbsp;: entre deux éléments `&lt;p&gt;`, et non pas à l’intérieur d’un `&lt;p&gt;`.

Dans un de vos chapitres, n’omettez pas d’ajouter une liste, balisée avec un élément `&lt;list&gt;`, contenant une séquence de `&lt;item&gt;` éléments, précédée d’un `&lt;head&gt;` facultatif.

---


# L’affichage du texte balisé

Est-ce que la quantité de balises dans votre document commence à vous inquiéter un peu&nbsp;?

On peut mettre en ordre le balisage que l’on a fait, en cliquant sur le bouton d’indentation, ou en tapant `Ctrl` + `Maj` + `P`, ou en sélectionnant `Source` → `Indenter le document` dans le menu `Document`. Mais peut être préféreriez-vous voir disparaître les balises&nbsp;?

* Au fond de la fenêtre vous voyez trois onglets&nbsp;: `Texte`, `Grille`, et `Auteur`. Sélectionnez le dernier. L’affichage de votre document change, et un nouveau menu `TEI P5` devient disponible. Sur ce menu, sélectionnez `Mode d’affichage` des balises et regardez les possibilités offertes par ces options.

* L’option `Toutes les balises` affiche les balises en icônes&nbsp;; l’option `Aucune balise` les fait disparaître totalement.

* Notez en plus que votre document est maintenant stylé&nbsp;; il y a des changements de police&nbsp;; les retours de ligne sont traités comme des blancs&nbsp;; etc.

* Dans le mode auteur, on peut diviser un élément simplement en tapant ENTRÉE deux fois. Vous pouvez essayez.

Sachez que vous pourrez contrôler ici l’affichage de votre document avec une feuille de style CSS.

---


# Importation d’un document bureautique

La plupart des documents numériques que vous rencontrer le plus souvent vous paraissent sans doute indemnes de toute balise XML. Par exemple, les documents préparés à l’aide des outils bureautiques tels Microsoft Word ou avec Open Office se présentent en apparence comme du texte brut. Ce n’est qu’une apparence&nbsp;: En réalité derrière tout cela il existe un format XML, que l’on peut manipuler, et donc qu’on peut transformer dans un autre format XML comme celui de la TEI.

Vous trouverez dans votre dossier `exercices` un fichier intitulé `acteRoyal-s.docx` et un autre intitulé `acteRoyal.jpg`. Prenez connaissance de ces documents. Il s’agit d’un document manuscrit numérisé en mode image qui a ensuite été rapidement retranscrit avec Microsoft Word. On va se servir d’oXygen pour transformer automatiquement cette transcription en XML TEI.

En réalité, un fichier Microsoft Word au format docx est une archive compressée qui contient plusieurs autres fichiers, y compris des fichiers XML qu’on peut gérer et transformer avec oXygen comme n’importe quel autre fichier XML. La conversion prend en compte les styles du document existant dans le fichier, et peut être personnalisée.

* Chargez oXygen. Sélectionnez `Ouvrir` dans le menu `Fichier` (ou tapez `CTRL-O`, ou cliquez l’icône dossier) et sélectionnez le fichier `acteRoyal.docx` dans votre dossier `exercices` .

* Une fenêtre intitulée `Navigateur d’Archives` s’ouvre à gauche de l’écran principal. Vous pouvez y observer la structure de l’archive docx.

![](../images/navigateur-1.png)

* Cliquez sur la petite clef bleue à côté du dossier `word` pour voir ce qu’il contient

![](../images/navigateur-2.png)

* Sélectionnez le fichier `document.xml` et double-cliquez pour l’ouvrir (cela peut prendre un peu de temps si le fichier est volumineux)

* Voilà&nbsp;: c’est un document XML, plein de balises, pour la plupart appartenant à un espace de nom défini par Microsoft. C’est une manière peu élégante d’utiliser XML, convertissons-le&nbsp;!

* Avec ce fichier `document.xml` ouvert dans l’écran principal, sélectionnez `Transformation -&gt; Configurer les Scénario(s) de Transformation` du menu `Document`. Ou tapez `Ctrl` + `Maj` + `C`. Ou cliquez sur la petite icône en forme de clef à molette (celui-ci : )

* oXygen vous présente les options de transformation disponibles pour ce document, parmi lesquelles devrait figurer une transformation nommée DOCX TEI P5.

![](../images/configurer-1.png)

* Sélectionnez la case à cocher correspondante et cliquez sur le bouton `Appliquer associés` au dessous. Une nouvelle fenêtre s’ouvre en bas pour l’affichage des messages concernant le processus de transformation&nbsp;: vous pouvez les ignorer sans problème.

* Dans l’écran principal, un document TEI-conforme s’affiche. Sélectionnez `Source -&gt; Format and Indent` du menu `Document` menu, ou tapez `Ctrl` + `Maj` + `P` ou cliquez sur le bouton `Indent` (celui-ci : ) pour regarder sa structure

* L’attribut `@rend` indique le nom du style Word utilisé dans cette portion du document original. Une transformation XSLT plus complexe pourrait donc s’en servir pour effectuer une conversion plus intelligente.

---


La question qui s’impose&nbsp;: quelles balises devraient être disponibles pour une représentation efficace des aspects les plus signifiants du document&nbsp;?
</textarea><script src="js/remark-0.6.5.min.js" type="text/javascript"></script><script type="text/javascript">
        var hljs = remark.highlighter.engine;
      </script><script src="remark.language.js" type="text/javascript"></script><script type="text/javascript">
        var slideshow = remark.create({
        highlightStyle: 'monokai',
        highlightLanguage: 'remark'
        }) ;
      </script></body>
</html>
